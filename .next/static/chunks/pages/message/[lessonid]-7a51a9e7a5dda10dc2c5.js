_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[17],{"20a2":function(e,t,n){e.exports=n("nOHt")},LP3O:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/message/[lessonid]",function(){return n("zjFr")}])},zjFr:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return g}));var r=n("nKUr"),i=n("q1tI"),c=n("vJKn"),a=n.n(c),s=n("rg98"),o=n("JZFu"),u=n("20a2"),d=n("9yaX"),l=n("/MKj");n("WI49");function j(e){var t=Object(i.useState)(""),n=t[0],c=t[1],l=Object(i.useState)(""),j=l[0],b=l[1],f=Object(i.useState)(""),p=f[0],x=f[1],O=Object(i.useState)(""),h=O[0],m=O[1],v=Object(i.useState)(""),g=v[0],w=v[1],y=Object(i.useState)(""),_=(y[0],y[1],{backgroundColor:"#E0E0E0",borderRadius:"7px",height:"40px",verticalAlign:"middle",padding:"10px 20px 0px 20px",fontSize:"20px",display:"inline-block",marginBottom:"10px",marginLeft:"50px"}),E=[],S=[],k=Object(u.useRouter)(),N=d.a.encodeEmail(e.email),C=o.a.firestore(),q=function(){var e=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection("lessons").doc(k.query.lessonid).get().then((function(e){var t=e.data();c(t.createrid),m(t.lessonname),x(t.buyerid)}));case 2:return e.next=4,C.collection("users").doc(n).get().then((function(e){var t=e.data();w(t.profile.name)}));case 4:return e.next=6,C.collection("lessons").doc(k.query.lessonid).collection("message").orderBy("time").get().then((function(e){for(var t in e.forEach((function(e){E.push(e.data())})),E){var i=E[t].text;E[t].userid==N?S.push(Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{style:{marginBottom:"3px"},children:g}),Object(r.jsx)("div",{style:_,children:i}),Object(r.jsx)("br",{})]})):S.push(Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{style:_,children:i}),Object(r.jsx)("br",{})]}))}N==n||N==p?b(S):b(Object(r.jsx)("p",{children:"\u3054\u5229\u7528\u3044\u305f\u3060\u3051\u307e\u305b\u3093"}))}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[Object(r.jsx)("button",{onClick:q,children:"\u8aad\u307f\u8fbc\u307f"}),Object(r.jsx)("h2",{children:h}),j]})}var b=j=Object(l.b)((function(e){return e}))(j),f=n("r9w1"),p=n("R/WZ"),x=n("Z3vd"),O=Object(p.a)((function(e){return{root:{margin:e.spacing(1),width:"500px"},btn:{width:"80px",marginLeft:"210px"}}}));function h(e){var t=Object(i.useState)(""),n=t[0],c=t[1],l=Object(i.useState)(""),j=l[0],b=l[1],p=Object(u.useRouter)(),h=function(){var t=Object(s.a)(a.a.mark((function t(){var r,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=o.a.firestore(),i=d.a.encodeEmail(e.email),(new Date).getTime(),t.next=5,r.collection("lessons").doc(p.query.lessonid).collection("message").add({userid:i,text:n,time:o.a.firestore.FieldValue.serverTimestamp()}).then((function(){c("")}));case 5:i==createrid||i==buyerid?b(!1):b(!0);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),m=O();return Object(r.jsxs)("div",{children:[Object(r.jsx)("form",{className:m.root,noValidate:!0,autoComplete:"off",children:Object(r.jsx)(f.a,{id:"outlined-basic",variant:"outlined",onChange:function(e){c(e.target.value)},value:n,multiline:!0,rows:3,fullWidth:!0,disabled:j})}),Object(r.jsx)(x.a,{variant:"outlined",className:m.btn,onClick:h,disabled:j,children:"\u9001\u4fe1"})]})}var m=h=Object(l.b)((function(e){return e}))(h),v=n("OMfj");function g(){return Object(r.jsx)("div",{children:Object(r.jsxs)(v.a,{children:[Object(r.jsx)(b,{}),Object(r.jsx)(m,{})]})})}}},[["LP3O",1,2,4,5,6,0,3,7,8]]]);