{"code":"_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[17],{\"20a2\":function(e,t,n){e.exports=n(\"nOHt\")},LP3O:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/message/[lessonid]\",function(){return n(\"zjFr\")}])},zjFr:function(e,t,n){\"use strict\";n.r(t),n.d(t,\"default\",(function(){return g}));var r=n(\"nKUr\"),i=n(\"q1tI\"),c=n(\"vJKn\"),a=n.n(c),s=n(\"rg98\"),o=n(\"JZFu\"),u=n(\"20a2\"),d=n(\"9yaX\"),l=n(\"/MKj\");n(\"WI49\");function j(e){var t=Object(i.useState)(\"\"),n=t[0],c=t[1],l=Object(i.useState)(\"\"),j=l[0],b=l[1],f=Object(i.useState)(\"\"),p=f[0],x=f[1],O=Object(i.useState)(\"\"),h=O[0],m=O[1],v=Object(i.useState)(\"\"),g=v[0],w=v[1],y=Object(i.useState)(\"\"),_=(y[0],y[1],{backgroundColor:\"#E0E0E0\",borderRadius:\"7px\",height:\"40px\",verticalAlign:\"middle\",padding:\"10px 20px 0px 20px\",fontSize:\"20px\",display:\"inline-block\",marginBottom:\"10px\",marginLeft:\"50px\"}),E=[],S=[],k=Object(u.useRouter)(),N=d.a.encodeEmail(e.email),C=o.a.firestore(),q=function(){var e=Object(s.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.collection(\"lessons\").doc(k.query.lessonid).get().then((function(e){var t=e.data();c(t.createrid),m(t.lessonname),x(t.buyerid)}));case 2:return e.next=4,C.collection(\"users\").doc(n).get().then((function(e){var t=e.data();w(t.profile.name)}));case 4:return e.next=6,C.collection(\"lessons\").doc(k.query.lessonid).collection(\"message\").orderBy(\"time\").get().then((function(e){for(var t in e.forEach((function(e){E.push(e.data())})),E){var i=E[t].text;E[t].userid==N?S.push(Object(r.jsxs)(\"div\",{children:[Object(r.jsx)(\"p\",{style:{marginBottom:\"3px\"},children:g}),Object(r.jsx)(\"div\",{style:_,children:i}),Object(r.jsx)(\"br\",{})]})):S.push(Object(r.jsxs)(\"div\",{children:[Object(r.jsx)(\"div\",{style:_,children:i}),Object(r.jsx)(\"br\",{})]}))}N==n||N==p?b(S):b(Object(r.jsx)(\"p\",{children:\"\\u3054\\u5229\\u7528\\u3044\\u305f\\u3060\\u3051\\u307e\\u305b\\u3093\"}))}));case 6:case\"end\":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.jsxs)(\"div\",{children:[Object(r.jsx)(\"button\",{onClick:q,children:\"\\u8aad\\u307f\\u8fbc\\u307f\"}),Object(r.jsx)(\"h2\",{children:h}),j]})}var b=j=Object(l.b)((function(e){return e}))(j),f=n(\"r9w1\"),p=n(\"R/WZ\"),x=n(\"Z3vd\"),O=Object(p.a)((function(e){return{root:{margin:e.spacing(1),width:\"500px\"},btn:{width:\"80px\",marginLeft:\"210px\"}}}));function h(e){var t=Object(i.useState)(\"\"),n=t[0],c=t[1],l=Object(i.useState)(\"\"),j=l[0],b=l[1],p=Object(u.useRouter)(),h=function(){var t=Object(s.a)(a.a.mark((function t(){var r,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=o.a.firestore(),i=d.a.encodeEmail(e.email),(new Date).getTime(),t.next=5,r.collection(\"lessons\").doc(p.query.lessonid).collection(\"message\").add({userid:i,text:n,time:o.a.firestore.FieldValue.serverTimestamp()}).then((function(){c(\"\")}));case 5:i==createrid||i==buyerid?b(!1):b(!0);case 6:case\"end\":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),m=O();return Object(r.jsxs)(\"div\",{children:[Object(r.jsx)(\"form\",{className:m.root,noValidate:!0,autoComplete:\"off\",children:Object(r.jsx)(f.a,{id:\"outlined-basic\",variant:\"outlined\",onChange:function(e){c(e.target.value)},value:n,multiline:!0,rows:3,fullWidth:!0,disabled:j})}),Object(r.jsx)(x.a,{variant:\"outlined\",className:m.btn,onClick:h,disabled:j,children:\"\\u9001\\u4fe1\"})]})}var m=h=Object(l.b)((function(e){return e}))(h),v=n(\"OMfj\");function g(){return Object(r.jsx)(\"div\",{children:Object(r.jsxs)(v.a,{children:[Object(r.jsx)(b,{}),Object(r.jsx)(m,{})]})})}}},[[\"LP3O\",1,2,4,5,6,0,3,7,8]]]);","map":{"version":3,"sources":["static/chunks/pages/message/[lessonid]-7a51a9e7a5dda10dc2c5.js"],"names":["_N_E","window","push","20a2","module","exports","__webpack_require__","LP3O","__NEXT_P","zjFr","__webpack_exports__","r","d","_lessonid_message","jsx_runtime","react","regenerator","regenerator_default","n","asyncToGenerator","index_esm","next_router","address_lib","es","Message","props","_useState","Object","createrid","setCreaterid","_useState2","messages","setMessages","_useState3","buyerid","setBuyerid","_useState4","lessonname","setLessonname","_useState5","creatername","setCreaterName","_useState6","style","backgroundColor","borderRadius","height","verticalAlign","padding","fontSize","display","marginBottom","marginLeft","messagedata","messageitems","router","email","encodeEmail","db","firestore","getMessageData","_ref","a","mark","_callee","wrap","_context","prev","next","collection","doc","query","lessonid","get","then","lessondata","data","createrdata","profile","name","orderBy","querySnapshot","i","forEach","text","userid","children","stop","apply","this","arguments","onClick","message_Message","state","TextField","makeStyles","Button","useStyles","theme","root","margin","spacing","width","btn","MessageAdd","message","setMessage","userfilter","setUserfilter","doSubmit","Date","getTime","add","time","FieldValue","serverTimestamp","classes","className","noValidate","autoComplete","id","variant","onChange","e","target","value","multiline","rows","fullWidth","disabled","message_MessageAdd","Layout"],"mappings":"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"},"name":"static/chunks/pages/message/[lessonid]-7a51a9e7a5dda10dc2c5.js","input":"_N_E =\n(window[\"webpackJsonp_N_E\"] = window[\"webpackJsonp_N_E\"] || []).push([[17],{\n\n/***/ \"20a2\":\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(\"nOHt\")\n\n\n/***/ }),\n\n/***/ \"LP3O\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\n      (window.__NEXT_P = window.__NEXT_P || []).push([\n        \"/message/[lessonid]\",\n        function () {\n          return __webpack_require__(\"zjFr\");\n        }\n      ]);\n    \n\n/***/ }),\n\n/***/ \"zjFr\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"default\", function() { return /* binding */ _lessonid_message; });\n\n// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js\nvar jsx_runtime = __webpack_require__(\"nKUr\");\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(\"q1tI\");\n\n// EXTERNAL MODULE: ./node_modules/next/node_modules/@babel/runtime/regenerator/index.js\nvar regenerator = __webpack_require__(\"vJKn\");\nvar regenerator_default = /*#__PURE__*/__webpack_require__.n(regenerator);\n\n// EXTERNAL MODULE: ./node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\nvar asyncToGenerator = __webpack_require__(\"rg98\");\n\n// EXTERNAL MODULE: ./node_modules/firebase/dist/index.esm.js + 8 modules\nvar index_esm = __webpack_require__(\"JZFu\");\n\n// EXTERNAL MODULE: ./node_modules/next/router.js\nvar next_router = __webpack_require__(\"20a2\");\n\n// EXTERNAL MODULE: ./Lib/address_lib.js\nvar address_lib = __webpack_require__(\"9yaX\");\n\n// EXTERNAL MODULE: ./node_modules/react-redux/es/index.js + 22 modules\nvar es = __webpack_require__(\"/MKj\");\n\n// EXTERNAL MODULE: ./node_modules/firebase/storage/dist/index.esm.js\nvar dist_index_esm = __webpack_require__(\"WI49\");\n\n// CONCATENATED MODULE: ./components/message/Message.js\n\n\n\n\n\n\n\n\n\n\n\nfunction Message(props) {\n  //ステート定義\n  var _useState = Object(react[\"useState\"])(\"\"),\n      createrid = _useState[0],\n      setCreaterid = _useState[1];\n\n  var _useState2 = Object(react[\"useState\"])(\"\"),\n      messages = _useState2[0],\n      setMessages = _useState2[1];\n\n  var _useState3 = Object(react[\"useState\"])(\"\"),\n      buyerid = _useState3[0],\n      setBuyerid = _useState3[1];\n\n  var _useState4 = Object(react[\"useState\"])(\"\"),\n      lessonname = _useState4[0],\n      setLessonname = _useState4[1];\n\n  var _useState5 = Object(react[\"useState\"])(\"\"),\n      creatername = _useState5[0],\n      setCreaterName = _useState5[1];\n\n  var _useState6 = Object(react[\"useState\"])(\"\"),\n      buyername = _useState6[0],\n      setBuyerName = _useState6[1]; //送信者によってスタイルを変更するテスト用のスタイル\n\n\n  var style = {\n    // border:\"solid 1px #DDD\", \n    backgroundColor: \"#E0E0E0\",\n    borderRadius: \"7px\",\n    height: \"40px\",\n    verticalAlign: \"middle\",\n    padding: \"10px 20px 0px 20px\",\n    fontSize: \"20px\",\n    display: \"inline-block\",\n    marginBottom: \"10px\",\n    marginLeft: \"50px\"\n  };\n  var messagedata = [];\n  var messageitems = [];\n  var router = Object(next_router[\"useRouter\"])();\n  var email = address_lib[\"a\" /* default */].encodeEmail(props.email);\n  var db = index_esm[\"a\" /* default */].firestore(); //lessondata及びmessageを取得\n\n  var getMessageData = /*#__PURE__*/function () {\n    var _ref = Object(asyncToGenerator[\"a\" /* default */])( /*#__PURE__*/regenerator_default.a.mark(function _callee() {\n      return regenerator_default.a.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return db.collection(\"lessons\").doc(router.query.lessonid).get() //取得したデータをlessondataにしまってから、それをステートに突っ込む\n              .then(function (doc) {\n                var lessondata = doc.data();\n                setCreaterid(lessondata.createrid);\n                setLessonname(lessondata.lessonname);\n                setBuyerid(lessondata.buyerid);\n              });\n\n            case 2:\n              _context.next = 4;\n              return db.collection(\"users\").doc(createrid).get().then(function (doc) {\n                var createrdata = doc.data();\n                setCreaterName(createrdata.profile.name);\n              });\n\n            case 4:\n              _context.next = 6;\n              return db.collection(\"lessons\").doc(router.query.lessonid).collection(\"message\").orderBy(\"time\").get() //取得したデータをmessagedata配列に入れる。\n              //配列の繰り返し処理でメッセージのjsxを作り、\n              //messageitemsに入れて、最後にstateに入れる\n              .then(function (querySnapshot) {\n                querySnapshot.forEach(function (doc) {\n                  messagedata.push(doc.data());\n                });\n\n                for (var i in messagedata) {\n                  var text = messagedata[i].text;\n                  var userid = messagedata[i].userid; //送信者とReduxメアドの比較でスタイル分岐\n\n                  if (userid == email) {\n                    messageitems.push( /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\", {\n                      children: [/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"p\", {\n                        style: {\n                          marginBottom: \"3px\"\n                        },\n                        children: creatername\n                      }), /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\", {\n                        style: style,\n                        children: text\n                      }), /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"br\", {})]\n                    }));\n                  } else {\n                    messageitems.push( /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\", {\n                      children: [/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\", {\n                        style: style,\n                        children: text\n                      }), /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"br\", {})]\n                    }));\n                  }\n                } //作成者、購入者以外メッセージが見れないようにする\n\n\n                if (email == createrid || email == buyerid) {\n                  setMessages(messageitems);\n                } else {\n                  var errorMessage = /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"p\", {\n                    children: \"\\u3054\\u5229\\u7528\\u3044\\u305F\\u3060\\u3051\\u307E\\u305B\\u3093\"\n                  });\n\n                  setMessages(errorMessage);\n                }\n              });\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function getMessageData() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\", {\n    children: [/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"button\", {\n      onClick: getMessageData,\n      children: \"\\u8AAD\\u307F\\u8FBC\\u307F\"\n    }), /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"h2\", {\n      children: lessonname\n    }), messages]\n  });\n}\n\nMessage = Object(es[\"b\" /* connect */])(function (state) {\n  return state;\n})(Message);\n/* harmony default export */ var message_Message = (Message);\n// EXTERNAL MODULE: ./node_modules/@material-ui/core/esm/TextField/TextField.js + 40 modules\nvar TextField = __webpack_require__(\"r9w1\");\n\n// EXTERNAL MODULE: ./node_modules/@material-ui/core/esm/styles/makeStyles.js\nvar makeStyles = __webpack_require__(\"R/WZ\");\n\n// EXTERNAL MODULE: ./node_modules/@material-ui/core/esm/Button/Button.js\nvar Button = __webpack_require__(\"Z3vd\");\n\n// CONCATENATED MODULE: ./components/message/MessageAdd.js\n\n\n\n\n//メッセージ送信フォーム\n//message/[lessonid]でインポート\n\n\n\n\n\n\n\n\nvar useStyles = Object(makeStyles[\"a\" /* default */])(function (theme) {\n  return {\n    root: {\n      margin: theme.spacing(1),\n      width: '500px'\n    },\n    btn: {\n      width: \"80px\",\n      marginLeft: \"210px\"\n    }\n  };\n});\n\nfunction MessageAdd(props) {\n  //使用するステートの設定(Hook)\n  var _useState = Object(react[\"useState\"])(\"\"),\n      message = _useState[0],\n      setMessage = _useState[1];\n\n  var _useState2 = Object(react[\"useState\"])(\"\"),\n      userfilter = _useState2[0],\n      setUserfilter = _useState2[1]; //inputに入力された処理をeで受け取ってステートに入れる関数\n\n\n  var doChangeMessage = function doChangeMessage(e) {\n    setMessage(e.target.value);\n  };\n\n  var router = Object(next_router[\"useRouter\"])(); //追加ボタンを押したらfirebaseにステートの情報を書き込む処理\n  //addで追加しているから、ドキュメントidはユニークなidが自動で当てられる\n  //Reduxからユーザーのemail(id)をencode( .→* )にして定数に代入\n\n  var doSubmit = /*#__PURE__*/function () {\n    var _ref = Object(asyncToGenerator[\"a\" /* default */])( /*#__PURE__*/regenerator_default.a.mark(function _callee() {\n      var db, email, d;\n      return regenerator_default.a.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              db = index_esm[\"a\" /* default */].firestore();\n              email = address_lib[\"a\" /* default */].encodeEmail(props.email);\n              d = new Date().getTime();\n              _context.next = 5;\n              return db.collection(\"lessons\").doc(router.query.lessonid).collection(\"message\").add({\n                userid: email,\n                text: message,\n                time: index_esm[\"a\" /* default */].firestore.FieldValue.serverTimestamp()\n              }).then(function () {\n                setMessage(\"\");\n              });\n\n            case 5:\n              //userfilterのTorFを、マテリアルUIの表示に関する属性に用いて、\n              //作成者、購入者以外にフォームを表示しなくする予定\n              if (email == createrid || email == buyerid) {\n                setUserfilter(false);\n              } else {\n                setUserfilter(true);\n              }\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function doSubmit() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var classes = useStyles();\n  return /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\", {\n    children: [/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"form\", {\n      className: classes.root,\n      noValidate: true,\n      autoComplete: \"off\",\n      children: /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(TextField[\"a\" /* default */], {\n        id: \"outlined-basic\",\n        variant: \"outlined\",\n        onChange: doChangeMessage,\n        value: message,\n        multiline: true,\n        rows: 3,\n        fullWidth: true,\n        disabled: userfilter\n      })\n    }), /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(Button[\"a\" /* default */], {\n      variant: \"outlined\",\n      className: classes.btn,\n      onClick: doSubmit,\n      disabled: userfilter,\n      children: \"\\u9001\\u4FE1\"\n    })]\n  });\n}\n\nMessageAdd = Object(es[\"b\" /* connect */])(function (state) {\n  return state;\n})(MessageAdd);\n/* harmony default export */ var message_MessageAdd = (MessageAdd);\n// EXTERNAL MODULE: ./components/normal/Layout.js + 4 modules\nvar Layout = __webpack_require__(\"OMfj\");\n\n// CONCATENATED MODULE: ./pages/message/[lessonid].js\n\n\n\n\n\n\nfunction _lessonid_message() {\n  return /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"div\", {\n    children: /*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(Layout[\"a\" /* default */], {\n      children: [/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(message_Message, {}), /*#__PURE__*/Object(jsx_runtime[\"jsx\"])(message_MessageAdd, {})]\n    })\n  });\n}\n\n/***/ })\n\n},[[\"LP3O\",1,2,4,5,6,0,3,7,8]]]);","inputSourceMap":{"version":3,"sources":["C:\\Users\\t.osato\\Documents\\subero\\suberobeta_app-1\\node_modules\\next\\router.js","C:\\Users\\t.osato\\Documents\\subero\\suberobeta_app-1\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-client-pages-loader.js?page=%2Fmessage%2F%5Blessonid%5D&absolutePagePath=private-next-pages%2Fmessage%2F%5Blessonid%5D.js!","C:\\Users\\t.osato\\Documents\\subero\\suberobeta_app-1\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!C:\\Users\\t.osato\\Documents\\subero\\suberobeta_app-1\\components\\message\\Message.js","C:\\Users\\t.osato\\Documents\\subero\\suberobeta_app-1\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!C:\\Users\\t.osato\\Documents\\subero\\suberobeta_app-1\\components\\message\\MessageAdd.js","C:\\Users\\t.osato\\Documents\\subero\\suberobeta_app-1\\node_modules\\next\\dist\\build\\webpack\\loaders\\next-babel-loader.js??ref--4!C:\\Users\\t.osato\\Documents\\subero\\suberobeta_app-1\\pages\\message\\[lessonid].js"],"names":[],"mappings":"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","file":"x","sourcesContent":["module.exports = require('./dist/client/router')\n","\n      (window.__NEXT_P = window.__NEXT_P || []).push([\n        \"/message/[lessonid]\",\n        function () {\n          return require(\"private-next-pages/message/[lessonid].js\");\n        }\n      ]);\n    ","import _regeneratorRuntime from \"C:/Users/t.osato/Documents/subero/suberobeta_app-1/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _asyncToGenerator from \"C:/Users/t.osato/Documents/subero/suberobeta_app-1/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React, { useState } from \"react\";\nimport firebase from \"firebase\";\nimport { useRouter } from \"next/router\";\nimport Lib from \"../../Lib/address_lib\";\nimport { connect } from \"react-redux\";\nimport \"firebase/storage\";\n\nfunction Message(props) {\n  //ステート定義\n  var _useState = useState(\"\"),\n      createrid = _useState[0],\n      setCreaterid = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      messages = _useState2[0],\n      setMessages = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      buyerid = _useState3[0],\n      setBuyerid = _useState3[1];\n\n  var _useState4 = useState(\"\"),\n      lessonname = _useState4[0],\n      setLessonname = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      creatername = _useState5[0],\n      setCreaterName = _useState5[1];\n\n  var _useState6 = useState(\"\"),\n      buyername = _useState6[0],\n      setBuyerName = _useState6[1]; //送信者によってスタイルを変更するテスト用のスタイル\n\n\n  var style = {\n    // border:\"solid 1px #DDD\", \n    backgroundColor: \"#E0E0E0\",\n    borderRadius: \"7px\",\n    height: \"40px\",\n    verticalAlign: \"middle\",\n    padding: \"10px 20px 0px 20px\",\n    fontSize: \"20px\",\n    display: \"inline-block\",\n    marginBottom: \"10px\",\n    marginLeft: \"50px\"\n  };\n  var messagedata = [];\n  var messageitems = [];\n  var router = useRouter();\n  var email = Lib.encodeEmail(props.email);\n  var db = firebase.firestore(); //lessondata及びmessageを取得\n\n  var getMessageData = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return db.collection(\"lessons\").doc(router.query.lessonid).get() //取得したデータをlessondataにしまってから、それをステートに突っ込む\n              .then(function (doc) {\n                var lessondata = doc.data();\n                setCreaterid(lessondata.createrid);\n                setLessonname(lessondata.lessonname);\n                setBuyerid(lessondata.buyerid);\n              });\n\n            case 2:\n              _context.next = 4;\n              return db.collection(\"users\").doc(createrid).get().then(function (doc) {\n                var createrdata = doc.data();\n                setCreaterName(createrdata.profile.name);\n              });\n\n            case 4:\n              _context.next = 6;\n              return db.collection(\"lessons\").doc(router.query.lessonid).collection(\"message\").orderBy(\"time\").get() //取得したデータをmessagedata配列に入れる。\n              //配列の繰り返し処理でメッセージのjsxを作り、\n              //messageitemsに入れて、最後にstateに入れる\n              .then(function (querySnapshot) {\n                querySnapshot.forEach(function (doc) {\n                  messagedata.push(doc.data());\n                });\n\n                for (var i in messagedata) {\n                  var text = messagedata[i].text;\n                  var userid = messagedata[i].userid; //送信者とReduxメアドの比較でスタイル分岐\n\n                  if (userid == email) {\n                    messageitems.push( /*#__PURE__*/_jsxs(\"div\", {\n                      children: [/*#__PURE__*/_jsx(\"p\", {\n                        style: {\n                          marginBottom: \"3px\"\n                        },\n                        children: creatername\n                      }), /*#__PURE__*/_jsx(\"div\", {\n                        style: style,\n                        children: text\n                      }), /*#__PURE__*/_jsx(\"br\", {})]\n                    }));\n                  } else {\n                    messageitems.push( /*#__PURE__*/_jsxs(\"div\", {\n                      children: [/*#__PURE__*/_jsx(\"div\", {\n                        style: style,\n                        children: text\n                      }), /*#__PURE__*/_jsx(\"br\", {})]\n                    }));\n                  }\n                } //作成者、購入者以外メッセージが見れないようにする\n\n\n                if (email == createrid || email == buyerid) {\n                  setMessages(messageitems);\n                } else {\n                  var errorMessage = /*#__PURE__*/_jsx(\"p\", {\n                    children: \"\\u3054\\u5229\\u7528\\u3044\\u305F\\u3060\\u3051\\u307E\\u305B\\u3093\"\n                  });\n\n                  setMessages(errorMessage);\n                }\n              });\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function getMessageData() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsx(\"button\", {\n      onClick: getMessageData,\n      children: \"\\u8AAD\\u307F\\u8FBC\\u307F\"\n    }), /*#__PURE__*/_jsx(\"h2\", {\n      children: lessonname\n    }), messages]\n  });\n}\n\nMessage = connect(function (state) {\n  return state;\n})(Message);\nexport default Message;","import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"C:/Users/t.osato/Documents/subero/suberobeta_app-1/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/t.osato/Documents/subero/suberobeta_app-1/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n//メッセージ送信フォーム\n//message/[lessonid]でインポート\nimport React, { useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport firebase from \"firebase\";\nimport { useRouter } from \"next/router\";\nimport Lib from \"../../Lib/address_lib\";\nimport TextField from '@material-ui/core/TextField';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    root: {\n      margin: theme.spacing(1),\n      width: '500px'\n    },\n    btn: {\n      width: \"80px\",\n      marginLeft: \"210px\"\n    }\n  };\n});\n\nfunction MessageAdd(props) {\n  //使用するステートの設定(Hook)\n  var _useState = useState(\"\"),\n      message = _useState[0],\n      setMessage = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      userfilter = _useState2[0],\n      setUserfilter = _useState2[1]; //inputに入力された処理をeで受け取ってステートに入れる関数\n\n\n  var doChangeMessage = function doChangeMessage(e) {\n    setMessage(e.target.value);\n  };\n\n  var router = useRouter(); //追加ボタンを押したらfirebaseにステートの情報を書き込む処理\n  //addで追加しているから、ドキュメントidはユニークなidが自動で当てられる\n  //Reduxからユーザーのemail(id)をencode( .→* )にして定数に代入\n\n  var doSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var db, email, d;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              db = firebase.firestore();\n              email = Lib.encodeEmail(props.email);\n              d = new Date().getTime();\n              _context.next = 5;\n              return db.collection(\"lessons\").doc(router.query.lessonid).collection(\"message\").add({\n                userid: email,\n                text: message,\n                time: firebase.firestore.FieldValue.serverTimestamp()\n              }).then(function () {\n                setMessage(\"\");\n              });\n\n            case 5:\n              //userfilterのTorFを、マテリアルUIの表示に関する属性に用いて、\n              //作成者、購入者以外にフォームを表示しなくする予定\n              if (email == createrid || email == buyerid) {\n                setUserfilter(false);\n              } else {\n                setUserfilter(true);\n              }\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function doSubmit() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var classes = useStyles();\n  return /*#__PURE__*/_jsxs(\"div\", {\n    children: [/*#__PURE__*/_jsx(\"form\", {\n      className: classes.root,\n      noValidate: true,\n      autoComplete: \"off\",\n      children: /*#__PURE__*/_jsx(TextField, {\n        id: \"outlined-basic\",\n        variant: \"outlined\",\n        onChange: doChangeMessage,\n        value: message,\n        multiline: true,\n        rows: 3,\n        fullWidth: true,\n        disabled: userfilter\n      })\n    }), /*#__PURE__*/_jsx(Button, {\n      variant: \"outlined\",\n      className: classes.btn,\n      onClick: doSubmit,\n      disabled: userfilter,\n      children: \"\\u9001\\u4FE1\"\n    })]\n  });\n}\n\nMessageAdd = connect(function (state) {\n  return state;\n})(MessageAdd);\nexport default MessageAdd;","import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React from \"react\";\nimport Message from \"../../components/message/Message\";\nimport MessageAdd from \"../../components/message/MessageAdd\";\nimport Layout from \"../../components/normal/Layout\";\nexport default function message() {\n  return /*#__PURE__*/_jsx(\"div\", {\n    children: /*#__PURE__*/_jsxs(Layout, {\n      children: [/*#__PURE__*/_jsx(Message, {}), /*#__PURE__*/_jsx(MessageAdd, {})]\n    })\n  });\n}"]}}